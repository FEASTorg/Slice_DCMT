name: Generate KiBot index

on:
  workflow_call:

permissions:
  contents: write

jobs:
  generate-kibot-index:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: true
          fetch-depth: 0
      - uses: actions/setup-python@v4
        with: { python-version: "3.x" }
      - name: Install deps
        run: pip install markdown2 pyyaml
      - name: Generate docs/kibot/index.md
        run: |
          python scripts/gen_kibot_index.py \
            --config docs/site_config.yml \
            --template docs/kibot/index_template.md \
            --out-md docs/kibot/index.md
